# Описание
Телеграм-бота и бэкенд для приюта Преданное сердце.
- Используемый стек:
  - Django 5, aiogram 3.2.0
- Архитектура проекта:
  - СУБД - Postgres
  - Backend - Django
  - Bot - aiogram
  - Web-Server - Ngninx + Gunicorn
### Описание директорий проекта
- Bot - Телеграм-бот, написанный на фреймворке aiogram. 
- Backend - Бэкенд, написанный на фреймворке Django. 
- Nginx - Директория для хранения конфига nginx.
### Функциональные цели проекта: 
- Обеспечить удобное взаимодействие пользователя с информацией о приюте - часто задаваемые вопросы разных категорий, возомжность задать свой вопрос и простой доступ к основным страницам основого сайта Приюта.
### Достигнутые и запланированные
- Требования:
  - давать автоматические ответы (шаблоны) на часто задаваемые вопросы (список вопросов и ответов даст Заказчик). Например, часы работы, часы посещения, как отдать животное в приют, какие корма требуется и тд,
  - в боте можно менять/изменять шаблонные вопросы и ответы,
  - иметь возможность получить от юзера уникальный вопрос (которго нет в шаблонах), который будет пересылаться менеджеру (в Телеграм или e-mail),
  - отправлять адрес приюта по запросу пользователя,
  - отправлять ссылку на сайт (целевую страницу) для жертвователей, чтобы сделать пожертвование,
  - собирать и хранить e-mail адреса, ФИО и номер телефона пользователей (по желанию пользователя), отдавать в формате Excel
  - отправлять ссылку на целевую страницу со списком животных в приюте,
  - отправлять ссылку на целевую страницу для участия в Попечительской программе
- Все вышеописанные требования были достигнуты, однако:
  - Была реализована отправка сообщений И в telegram И на email.
  - Была реализована массовая рассылка новостей / акций / важной информации о приюте всем пользователям бота.
  - Была реализована удобная система категорий вопросов и их просмотра в боте. В админ панели можно удобно создать новый вопрос для любой из категорий.
  - Была реализована валидация вопросов, которые задаёт пользователь. Если в них содержатся нецензурные слова вопрос не сохраняется в БД, а администраторам не приходят уведомления об этом вопросе.
    
### Всё, что нужно, чтобы запустить проекта / работать с ним
- Инструкция по развёртыванию проекта локально
  - При локальном запуске Бэкенд и Бот запускаются как разные приложения.
    - Бэкенд:
      - Перейти в папку `/backend/faithful_heart`, создать файл `.env` на основе файла `.env.example`
      - В `.env` файле указать `DEBUG_MODE=True`, если хотите использовать `SQLite` как бд, в противном случае будет использован `Postgres`.
      - Создать миграции командой `python manage.py makemigrations`.
      - Применить миграции командной `python manage.py migrate`.
      - Вопросы можно загрузить в БД как фикстуры командой `python manage.py loaddata data/fixtures.json`. Эти вопросы были взяты из брифа и разбиты на категории.
      - Запустить сервер можно командой `python manage.py runserver`.
    - Бот:
      - Перейти в папку `/bot `.
      - Создать `.env` файл на основе `.env.example`.
      - Запустить бота командой `python main.py`.
- Инструкция по развёртыванию проекта в контейнерах 
  - Для развёртывания в контейнерах необходимо создать .env файлы, 2 описано выше, но также в корневой директории необходимо написать `.env` файл на основе `.env.example`.
- Как запустить тесты
  - Тесты были реализованы только для Бэкенда, ввиду ограничений на тестирование Ботов.
  - Тесты для Бэкенда можно запустить командой `pytest` в директории `/backend/faithful_heart`.
- Рекомендации для разработчиков 
  - Для корректной работы бота необходимо выполнить следующие пункты:
    - При создании Админа, в админ-панели указать в объекте `telegram_username`. При этом пользователь Telegram с таким `telegram_username` должен быть сохранён в базе.
    - Также у Админа должен быть заполнен `email`.
### Договорённости именования веток, стиль кода и т.п.

## Правила использования веток.
* Под каждую таску содаётся ветка с понятным названием, отражающим содержание.
* Добавление материала производится по средствам пул-реквестов в ветку dev.
* После слияния ветка удаляется.
## Нейминг веток.
* В зависимости от действия (добавление / исправление) используются названия (feature / bug) соотвественно.
* Пример итогового названия веток: `feature/added_core_backend`, `bug/edited_{filename}_extension`.
## Порядок пул-реквестов.
* Создание ветки.
* Добавление кода.
* Рефракторинг.
